<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EMPLOYER - HOME</title>
    <link
      rel="icon"
      type="image/png"
      href="{{ url_for('static', filename='Assets/PESO_logo.png') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/employer.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/loader.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/chat.css') }}"
    />
  </head>
  <body
    data-must-change-password="{{ 'true' if session.must_change_password else 'false' }}"
  >
    <!-- Added flash messages section for success/error notifications -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, msg in messages %}
    <div class="flash {{ 'success' if category=='success' else 'danger' }}">
      {{ msg }}
      <button class="close" onclick="this.parentElement.remove()">×</button>
    </div>
    {% endfor %}
    <script>
      setTimeout(() => {
        const flashes = document.querySelectorAll(".flash");
        flashes.forEach((f) => f.classList.add("fade-out"));
        setTimeout(() => {
          flashes.forEach((f) => f.remove());
        }, 500);
      }, 3000);
    </script>
    {% endif %} {% endwith %}

    <!-- Added Force Password Modal -->
    <!-- Force Password Modal -->
    <div id="forcePasswordModal" class="custom-modal">
      <div class="modal-content">
        <h5>Change Your Password</h5>
        <p>
          For security, you must change your password before accessing your
          account.
        </p>
        <div class="passwordRequirementsCard">
          <!-- Password Requirements Notice -->
          <ul id="passwordRequirements">
            <li>At least 8 characters long</li>
            <li>Contains uppercase and lowercase letters</li>
            <li>Includes at least one number</li>
            <li>Has at least one special character (@, $, !, %, *, ?, &)</li>
          </ul>
        </div>
        <form
          id="forcePasswordForm"
          method="POST"
          action="{{ url_for('employers.forced_password_change') }}"
        >
          <div class="password-wrapper">
            <input
              type="password"
              id="newPassword"
              name="newPassword"
              placeholder="New Password"
              required
            />
            <span class="toggle-password">Show</span>
          </div>
          <div class="password-wrapper">
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              placeholder="Confirm Password"
              required
            />
            <span class="toggle-password">Show</span>
          </div>
          <!--  Live feedback (invalid, mismatch, etc.) -->
          <small
            id="passwordHint"
            style="color: #ff6666; display: block; margin-top: 5px"
          ></small>
          <button type="submit" id="submitBtn" class="submitBtn" disabled>
            Change Password
          </button>
        </form>
      </div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="logo">
          <img
            src="{{ url_for('static', filename='Assets/PESO_logo.png') }}"
            alt="PESO SmartHire Logo"
          />
        </div>
        <nav class="nav">
          <a
            href="{{url_for('employers.employer_home')}}"
            class="nav-link-active"
            >Home</a
          >
          <a
            href="{{url_for('employers.application_management')}}"
            class="nav-link"
            >Job Applications</a
          >
          <a href="{{url_for('employers.notifications')}}" class="nav-link"
            >Notification<span
              id="employerNotifBadge"
              class="notif-badge"
              style="display: none"
              >●</span
            ></a
          >
          <a href="{{url_for('employers.account_security')}}" class="nav-link"
            >Account & Security</a
          >
          <a href="{{url_for('logout')}}" id="logoutLink" class="nav-link"
            >Log Out</a
          >
        </nav>
      </div>
    </header>

    <section class="hero">
      <div class="hero-background">
        <img
          src="{{ url_for('static', filename='Assets/background.png') }}"
          alt="New City Hall of Lipa CIty"
        />
      </div>
      <div class="hero-content">
        <div class="container">
          <h1 class="hero-title">
            Welcome{% if session.employer_name %}, {{ session.employer_name }}{%
            endif %}!
          </h1>
          <p class="hero-description">Here's what we have today</p>
        </div>
      </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <div class="form-header">
          <h2 class="form-title">Create New Job Post</h2>
          <p class="form-instruction">
            Fill out the form below to create a new job posting for your company
          </p>
        </div>

        <!-- Job Form Section -->
        <section class="job-form-section">
          <h3 class="section-title">Job Vacancy Details</h3>

          <form
            id="createJobForm"
            method="POST"
            action="{{ url_for('employers.create_job') }}"
          >
            <input
              type="hidden"
              name="employer_id"
              value="{{ current_employer_id }}"
            />

            <div class="form-row">
              <div class="form-group">
                <label for="job_position">Job Position</label>
                <input
                  type="text"
                  id="job_position"
                  name="job_position"
                  placeholder="Job Position"
                  required
                />
                <span class="error-message"></span>
              </div>

              <div class="form-group">
                <label for="work_schedule">Work Schedule</label>
                <select id="work_schedule" name="work_schedule" required>
                  <option value="">Select Schedule</option>
                  <option value="full-time">Full Time</option>
                  <option value="part-time">Part Time</option>
                  <option value="contract">Contract</option>
                  <option value="freelance">Freelance</option>
                </select>
                <span class="error-message"></span>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="num_vacancy">Number of Vacancy</label>
                <input
                  type="number"
                  id="num_vacancy"
                  name="num_vacancy"
                  value="1"
                  min="1"
                  required
                />
                <span class="error-message"></span>
              </div>

              <div class="form-group">
                <label for="min_salary">Minimum Salary (₱)</label>
                <input
                  type="number"
                  id="min_salary"
                  name="min_salary"
                  placeholder="1.00"
                  min="0"
                  step="0.01"
                  required
                />
                <span class="error-message"></span>
              </div>

              <div class="form-group">
                <label for="max_salary">Maximum Salary (₱)</label>
                <input
                  type="number"
                  id="max_salary"
                  name="max_salary"
                  placeholder="1.00"
                  min="0"
                  step="0.01"
                  required
                />
                <span class="error-message"></span>
              </div>
            </div>

            <div class="form-group">
              <label for="job_description">Job Description</label>
              <textarea
                id="job_description"
                name="job_description"
                placeholder="Description"
                rows="4"
                required
              ></textarea>
              <span class="error-message"></span>
            </div>

            <div class="form-group">
              <label for="qualifications">Qualifications</label>
              <textarea
                id="qualifications"
                name="qualifications"
                placeholder="Qualifications"
                rows="4"
                required
              ></textarea>
              <span class="error-message"></span>
            </div>

            <div class="form-actions">
              <button type="reset" class="btn btn-outline">Clear Form</button>
              <button type="submit" class="btn btn-primary">
                Create Job Post
              </button>
            </div>
          </form>
        </section>

        <!-- Hidden the "Add Job Vacancy" button to prevent duplicate job creation -->
        <!--<div class="add-btn-container" style="display: none">
          <button class="add-job-btn" id="addJobVacancy">
            Add Job Vacancy
          </button>
        </div>-->
      </div>
    </main>

    <div id="live-chat-widget">
      <button id="chat-trigger" onclick="toggleChatWindow()">
        <i class="fa-solid fa-headset"></i> Support
      </button>

      <div id="chat-interface" class="hidden">
        <div class="chat-header">
          <span>PESO Support</span>
          <button onclick="toggleChatWindow()">&times;</button>
        </div>
        <div id="chat-body">
          <div class="loading-chat">Loading history...</div>
        </div>
        <div class="chat-footer">
          <input
            type="text"
            id="userMsgInput"
            placeholder="Type a message..."
            onkeypress="handleEnter(event)"
          />
          <button onclick="sendUserMessage()">
            <i class="fa-solid fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-left">
            <h3>PESO SmartHire</h3>
            <p>
              Connecting talent with opportunity through innovative recruitment
              solutions.
            </p>
            <a href="{{url_for('terms_and_conditions')}}" class="footer-note"
              >Terms and Conditions</a
            >
            <p class="copyright">© 2025 PESO SmartHire. All rights reserved.</p>
          </div>
          <div class="footer-right">
            <h3>Development Team</h3>
            <div class="team-member">
              <span>Anoya, Ruffa F.</span>
              <div class="social-links">
                <a href="https://github.com/anoyaruffa" target="_blank"
                  ><i class="devicon-github-plain"></i
                ></a>
                <a href="#"><i class="devicon-facebook-plain"></i></a>
                <a href="mailto: ruffaanoya2005@gmail.com" target="_blank"
                  ><i class="fa-solid fa-envelope"></i
                ></a>
              </div>
            </div>
            <div class="team-member">
              <span>Levita, Reymark A.</span>
              <div class="social-links">
                <a href="https://github.com/elliwinx" target="_blank"
                  ><i class="devicon-github-plain"></i
                ></a>
                <a
                  href="https://www.facebook.com/reymark.levita.3"
                  target="_blank"
                  ><i class="devicon-facebook-plain"></i
                ></a>
                <a href="mailto:levitareymark11@gmail.com" target="_blank"
                  ><i class="fa-solid fa-envelope"></i
                ></a>
              </div>
            </div>
            <div class="team-member">
              <span>Samonte, Ralph Matthew A.</span>
              <div class="social-links">
                <a href="https://github.com/RalphWreckeri2" target="_blank"
                  ><i class="devicon-github-plain"></i
                ></a>
                <a
                  href="https://www.facebook.com/ralphmatthew.13"
                  target="_blank"
                  ><i class="devicon-facebook-plain"></i
                ></a>
                <a href="mailto:ralphmatthew.samonte@gmail.com" target="_blank"
                  ><i class="fa-solid fa-envelope"></i
                ></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Global loader partial -->
    {% include 'partials/loader.html' %}
    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/logout.js') }}"></script>
    <script src="{{ url_for('static', filename='js/employer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/notification_dot.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
  </body>
</html>
